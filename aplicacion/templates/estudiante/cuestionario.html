{% extends 'base.html' %}
{% load static %}

{% block title %}Cuestionario{% endblock %}

{% block extra_css %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/cuestionario.css' %}">
{% endblock %}

{% block navbar %}
<nav class="navbar navbar-expand-lg bg-white navbar-light shadow sticky-top p-0">
    <a href="{% url 'estudiante:home_estudiante' %}" class="navbar-brand d-flex align-items-center px-4 px-lg-5">
        <img src="{% static 'img/logo_ucn.jpg' %}" alt="Logo Facultad de Medicina"
            style="height: 55px; width: 55px; border-radius: 50%; margin-right: 10px;">
        <h2 class="navbar-title">UCN Kinesiologia</h2>
    </a>
    <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
        <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarCollapse">
        <div class="navbar-nav ms-auto p-4 p-lg-0">

            <a href="{% url 'estudiante:home_estudiante' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'home_estudiante' %}active{% endif %}">Cursos</a>
            <a href="{% url 'estudiante:perfil_estudiante' %}" class="nav-item nav-link">Perfil</a>
            <a href="{% url 'estudiante:logout' %}" class="btn btn-warning py-4 px-lg-5 d-none d-lg-block">Cerrar Sesión</a>
        </div>
    </div>
</nav>
{% endblock %}

{% block content %}
<div class="container-fluid container-curso">
  <div class="row gx-0">
    <div class="col-md-3">
      <div id="sidebarCurso" class="sidebar-curso list-group">
        <a href="#" class="list-group-item list-group-item-action fw-bold disabled">
          Curso: {{ curso_actual.nombre_del_Curso }}
        </a>
        <a href="#" class="list-group-item list-group-item-action active">
          <i class="fas fa-question-circle"></i> Test Your Knowledge
        </a>
        <a href="#" class="list-group-item list-group-item-action">
          <i class="fas fa-user-friends"></i> Postura
        </a>
        <a href="#" class="list-group-item list-group-item-action">
          <i class="fas fa-chair"></i> Ergonomía
        </a>
        <a href="#" class="list-group-item list-group-item-action">
          <i class="fas fa-dumbbell"></i> Biomecánica
        </a>
      </div>
    </div>
    <div class="col-md-9">
      <div id="mainCursoContent" class="main-curso-content">
        <div class="text-center">
          <img src="{% static 'img/logo_ucn.jpg' %}" alt="" style="height:80px; border-radius: 50%;" class="mb-2">
          <h1 class="fw-bold text-primary mb-2">Cuestionario - {{ curso_actual.nombre_del_Curso }}</h1>
        </div>
        <div class="alert alert-info text-start mb-3 mx-auto" style="max-width:650px;">
          <strong>Instrucciones:</strong> Responde todas las preguntas para completar el cuestionario. Los puntajes se mostrarán luego de enviar.
        </div>
        <form id="cuestionarioForm" method="POST" style="max-width:680px; margin: 0 auto;">
          {% csrf_token %}
          <h3 class="text-start mb-4">Total de preguntas: {{ preguntas|length }}</h3>
          {% for pregunta in preguntas %}
          <div class="pregunta-card mb-4" data-index="{{ forloop.counter0 }}">
              <div class="d-flex flex-row align-items-center mb-2">
                  <span class="badge bg-primary me-2" style="font-size:1.2em;">{{ forloop.counter }}</span>
                  <h5 class="fw-bold mb-0">{{ pregunta.enunciado }}</h5>
              </div>
              <hr>
              {% for respuesta in pregunta.respuesta_set.all %}
              <div class="form-check mb-2">
                  <input class="form-check-input" type="radio"
                      name="pregunta_{{ pregunta.id }}"
                      id="respuesta_{{ respuesta.id }}"
                      value="{{ respuesta.id }}">
                  <label class="form-check-label" for="respuesta_{{ respuesta.id }}">
                      {{ respuesta.retro }}
                  </label>
              </div>
              {% endfor %}
          </div>
          {% endfor %}
          <div class="d-flex justify-content-end gap-3 mt-4 mb-5">
              <button type="button" id="btnSiguiente" class="btn btn-primary btn-lg px-4">Siguiente</button>
              <button type="submit" id="btnEnviar" class="btn btn-success btn-lg px-4">Enviar</button>
          </div>
        </form>
        <div class="text-start mt-5 mb-4" style="max-width:680px; margin-left: auto; margin-right: auto;">
          <a href="{% url 'estudiante:home_estudiante' %}" class="btn btn-secondary btn-lg px-4">
              <i class="fas fa-arrow-left me-2"></i>Volver a Mis Cursos
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/cuestionario.js' %}"></script>
{% endblock %}