{% extends 'casos/base_casos.html' %}
{% load static %}

{% block title %}{{ caso.caso }} - Partes del Cuerpo{% endblock %}

{% block content %}
<head>
    <title>Evaluación - {{ paciente.nombre }}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/casos.css' %}">
</head>
<body>
    <div class="container">
        <!-- Navegación -->
        <div class="nav-buttons">
            <a href="{% url 'Caso_Clinico:seleccionar_paciente' caso.id parte.id %}" 
               style="color: #003366; text-decoration: none;">
                <i class="fas fa-arrow-left"></i> Volver a selección de paciente
            </a>
            <a href="{% url 'Caso_Clinico:detalle_caso' caso.id %}" 
               style="color: #003366; text-decoration: none;">
                <i class="fas fa-home"></i> Volver al caso clínico
            </a>
        </div>

        <div class="etapa-container">
            <h1>Ficha clínica</h1>
            
            <div class="paciente-info">
                <h2>Información personal</h2>
                <div class="paciente-details">
                    <p><strong>Nombre:</strong> {{ paciente.nombre }} | <strong>Edad:</strong> {{ paciente.edad }} años</p>
                    <p><strong>Parte del cuerpo:</strong> {{ parte.ParteCuerpo }}</p>
                    <p><strong>Ocupación:</strong> {{ paciente.ocupacion }}</p>
                    <p><strong>Previsión:</strong> {{ paciente.prevision }}</p>
                </div>
            </div>
        </div>

        <!-- Lista de etapas -->
        <div class="etapas-section">
            <h3>Proceso de Evaluación</h3>
            
            {% for etapa in etapas %}
                <div class="etapa-activa" id="etapa-{{ etapa.id }}">
                    <h4>Etapa {{ forloop.counter }}: {{ etapa.nombre }}</h4>
                </div>
            {% empty %}
                <p>No hay etapas definidas para esta evaluación.</p>
            {% endfor %}

            {% if etapas %}
                <div class="comenzar-container">
                    <a href="{% url 'Caso_Clinico:etapa_detalle' caso.id parte.id paciente.id etapas.0.id %}" 
                       class="btn-comenzar">
                        <i class="fas fa-arrow-right"></i> Comenzar Evaluación
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}
</body>
</html>