{% extends 'casos/base_casos.html' %}
{% load static %}
{% block content %}
<head>
    <title>Seleccionar Paciente - {{ parte.ParteCuerpo }}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/casos.css' %}">
</head>
<style>
     .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 20px;
    }
</style>
<body>
    <div class="container">
        <a href="{% url 'Caso_Clinico:detalle_caso' caso.id %}" class="volver-btn">
            <i class="fas fa-arrow-left"></i> Volver a partes del cuerpo
        </a>
        <h1>Seleccionar Paciente</h1>
        <p style="color: #AC6D33; font-weight: 600;">Evaluando: {{ parte.ParteCuerpo }} (Caso: {{ caso.caso }})</p>
        <h2>Pacientes Disponibles</h2>
        
        {% if relaciones %}
            {% for relacion in relaciones %}
            
            <div class="paciente-card" onclick="window.location='{% url "Caso_Clinico:ver_etapas" caso_id=caso.id parte_id=parte.id paciente_id=relacion.Pacientes.id %}'">
                <div class="paciente-info">
                    <div class="paciente-detail">
                        <h3><i class="fas fa-user-circle" style="color: #7E9BC0;"></i> {{ relacion.Pacientes.nombre }}</h3>
                        <p><strong><i class="fas fa-calendar-alt"></i> Fecha Nacimiento:</strong> {{ relacion.Pacientes.fecha_nacimiento }}</p>
                        <p><strong><i class="fas fa-chart-line"></i> Previsión:</strong> {{ relacion.Pacientes.prevision }}</p>
                        <p><strong><i class="fas fa-briefcase"></i> Ocupación:</strong> {{ relacion.Pacientes.ocupacion }}</p>
                    </div>
                    <div>
                        <a href="{% url 'Caso_Clinico:ver_etapas' caso.id parte.id relacion.Pacientes.id %}" class="btn-continuar">
                            <i class="fas fa-play-circle"></i> Comenzar Evaluación
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="no-pacientes-info">
                <i class="fas fa-user-slash fa-3x" style="color: #dc3545; margin-bottom: 15px;"></i>
                <h3>No hay pacientes asignados para esta parte del cuerpo.</h3>
                <p>Por favor, contacta a tu docente o administrador para verificar la asignación de pacientes a este caso clínico.</p>
            </div>
        {% endif %}
    </div>
</body>
{% endblock %}
</html>